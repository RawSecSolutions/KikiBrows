<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>KIKIBROWS - Editar Módulo</title>
    
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css">
    
    <link rel="stylesheet" href="css/fonts.css"> 
    <link rel="stylesheet" href="css/layoutAdmin.css">
    <link rel="stylesheet" href="css/dashboardAdmin.css"> 
    <link rel="stylesheet" href="css/gestorModulos.css"> 
</head>
<body>
    
    <header id="navbar-global"></header>

    <main class="container-fluid py-4">
        <div class="row justify-content-center">
            <div class="col-12 col-xl-10">
                
                <!-- Header -->
                <div class="d-flex align-items-center mb-4">
                    <a href="creaCurso.html" class="btn btn-link text-secondary p-0 me-3" id="backToCourse">
                        <i class="fas fa-arrow-left fa-lg"></i>
                    </a>
                    <div>
                        <h1 class="page-title mb-0">Gestor de Cursos</h1>
                        <small class="text-muted">Edición de módulo</small>
                    </div>
                </div>

                <form id="moduleEditForm">
                    <div class="row g-4">
                        
                        <!-- Info del Módulo -->
                        <div class="col-lg-5">
                            <div class="card-section">
                                <h2 class="section-title">Nombre del módulo</h2>
                                
                                <div class="mb-4">
                                    <input type="text" class="form-control input-kikibrows input-lg" id="moduleName" 
                                           placeholder="Escribe el nombre del módulo" required>
                                </div>
                                
                                <div class="mb-4">
                                    <label for="moduleDescription" class="form-label">Descripción</label>
                                    <textarea class="form-control input-kikibrows" id="moduleDescription" rows="4" 
                                              placeholder="Describe el contenido de este módulo..."></textarea>
                                </div>
                                
                                <div class="mb-4">
                                    <label class="form-label">Duración del módulo</label>
                                    <div class="duration-display" id="moduleDurationDisplay">
                                        <i class="fas fa-clock me-2"></i>
                                        <span id="moduleDurationText">27 min</span>
                                    </div>
                                    <small class="text-muted">Calculada según las clases</small>
                                </div>
                                
                                <button type="button" class="btn-confirmar" id="saveModuleInfo">
                                    <i class="fas fa-check me-2"></i>Confirmar
                                </button>
                            </div>
                        </div>

                        <!-- Clases del módulo -->
                        <div class="col-lg-7">
                            <div class="card-section">
                                <h2 class="section-title">Clases del módulo</h2>
                                
                                <p class="text-muted small mb-3">
                                    Las clases pueden ser: video educativo, texto/lección teórica, recurso descargable (PDF), 
                                    quiz de evaluación o entrega práctica.
                                </p>
                                
                                <!-- Lista de clases (drag and drop) -->
                                <div id="clasesContainer" class="sortable-container">
                                    <!-- Clase 1: Video -->
                                    <div class="clase-item" data-clase-id="1" data-tipo="video" draggable="true">
                                        <div class="drag-handle" title="Arrastra para reordenar">
                                            <i class="fas fa-grip-vertical"></i>
                                        </div>
                                        <div class="clase-info">
                                            <i class="fas fa-play-circle clase-icon text-primary"></i>
                                            <span class="clase-name">Clase 1: Nombre de clase</span>
                                            <span class="clase-duration">8 min.</span>
                                        </div>
                                        <div class="clase-actions">
                                            <button type="button" class="btn-clase-edit" title="Editar">
                                                <i class="fas fa-pen"></i>
                                            </button>
                                        </div>
                                    </div>
                                    
                                    <!-- Clase 2: Video -->
                                    <div class="clase-item" data-clase-id="2" data-tipo="video" draggable="true">
                                        <div class="drag-handle" title="Arrastra para reordenar">
                                            <i class="fas fa-grip-vertical"></i>
                                        </div>
                                        <div class="clase-info">
                                            <i class="fas fa-play-circle clase-icon text-primary"></i>
                                            <span class="clase-name">Clase 2: Nombre de clase</span>
                                            <span class="clase-duration">9 min.</span>
                                        </div>
                                        <div class="clase-actions">
                                            <button type="button" class="btn-clase-edit" title="Editar">
                                                <i class="fas fa-pen"></i>
                                            </button>
                                        </div>
                                    </div>
                                    
                                    <!-- Clase 3: PDF -->
                                    <div class="clase-item" data-clase-id="3" data-tipo="pdf" draggable="true">
                                        <div class="drag-handle" title="Arrastra para reordenar">
                                            <i class="fas fa-grip-vertical"></i>
                                        </div>
                                        <div class="clase-info">
                                            <i class="fas fa-file-pdf clase-icon text-danger"></i>
                                            <span class="clase-name">Clase 3: Nombre de clase</span>
                                            <span class="clase-duration">5 min.</span>
                                        </div>
                                        <div class="clase-actions">
                                            <button type="button" class="btn-clase-edit" title="Editar">
                                                <i class="fas fa-pen"></i>
                                            </button>
                                        </div>
                                    </div>
                                    
                                    <!-- Clase 4: Entrega práctica -->
                                    <div class="clase-item" data-clase-id="4" data-tipo="entrega" draggable="true">
                                        <div class="drag-handle" title="Arrastra para reordenar">
                                            <i class="fas fa-grip-vertical"></i>
                                        </div>
                                        <div class="clase-info">
                                            <i class="fas fa-upload clase-icon text-warning"></i>
                                            <span class="clase-name">Clase 4: Nombre de clase</span>
                                            <span class="clase-duration">5 min.</span>
                                        </div>
                                        <div class="clase-actions">
                                            <button type="button" class="btn-clase-edit" title="Editar">
                                                <i class="fas fa-pen"></i>
                                            </button>
                                        </div>
                                    </div>
                                </div>
                                
                                <!-- Botón Crear clase -->
                                <button type="button" class="btn-crear-clase mt-3" id="addClaseBtn">
                                    <i class="fas fa-plus me-2"></i>Crear
                                </button>
                            </div>
                        </div>

                        <!-- Botones de acción -->
                        <div class="col-12">
                            <div class="d-flex justify-content-between">
                                <a href="creaCurso.html" class="btn btn-outline-secondary px-4">
                                    <i class="fas fa-arrow-left me-2"></i>Volver al curso
                                </a>
                                <button type="submit" class="btn-confirmar">
                                    <i class="fas fa-save me-2"></i>Guardar módulo
                                </button>
                            </div>
                            
                            <div class="alert alert-success mt-3 d-none" id="saveSuccessAlert">
                                <i class="fas fa-check-circle me-2"></i>
                                Módulo guardado exitosamente
                            </div>
                        </div>
                        
                    </div>
                </form>

            </div>
        </div>
    </main>

    <!-- Modal: Crear/Seleccionar tipo de clase -->
    <div class="modal fade" id="claseTypeModal" tabindex="-1">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content modal-kikibrows">
                <div class="modal-header border-0">
                    <h5 class="modal-title">¿Qué tipo de clase deseas crear?</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <div class="clase-type-grid">
                        <button type="button" class="clase-type-btn" data-tipo="video">
                            <i class="fas fa-play-circle"></i>
                            <span>Video Educativo</span>
                        </button>
                        <button type="button" class="clase-type-btn" data-tipo="texto">
                            <i class="fas fa-file-alt"></i>
                            <span>Lección Teórica</span>
                        </button>
                        <button type="button" class="clase-type-btn" data-tipo="pdf">
                            <i class="fas fa-file-pdf"></i>
                            <span>Recurso PDF</span>
                        </button>
                        <button type="button" class="clase-type-btn" data-tipo="quiz">
                            <i class="fas fa-question-circle"></i>
                            <span>Quiz</span>
                        </button>
                        <button type="button" class="clase-type-btn" data-tipo="entrega">
                            <i class="fas fa-upload"></i>
                            <span>Entrega Práctica</span>
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal: Editar clase (genérico) -->
    <div class="modal fade" id="editClaseModal" tabindex="-1">
        <div class="modal-dialog modal-dialog-centered modal-lg">
            <div class="modal-content modal-kikibrows">
                <div class="modal-header border-0">
                    <h5 class="modal-title" id="editClaseModalTitle">Editar Clase</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <div class="mb-3">
                        <label class="form-label">Nombre de la clase</label>
                        <input type="text" class="form-control input-kikibrows" id="editClaseName" 
                               placeholder="Ej: Introducción a la técnica">
                    </div>
                    
                    <div class="mb-3">
                        <label class="form-label">Descripción (opcional)</label>
                        <textarea class="form-control input-kikibrows" id="editClaseDesc" rows="2"
                                  placeholder="Breve descripción"></textarea>
                    </div>
                    
                    <!-- Contenido específico según tipo -->
                    <div id="claseContentArea">
                        <!-- Se llena dinámicamente según el tipo de clase -->
                    </div>
                    
                    <div class="row g-3">
                        <div class="col-auto">
                            <label class="form-label">Duración estimada</label>
                            <div class="input-group" style="width: 150px;">
                                <input type="number" class="form-control input-kikibrows" id="editClaseDuration" 
                                       placeholder="5" min="1">
                                <span class="input-group-text">min</span>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="modal-footer border-0">
                    <button type="button" class="btn btn-outline-danger me-auto" id="deleteClaseBtn">
                        <i class="fas fa-trash me-1"></i>Eliminar
                    </button>
                    <button type="button" class="btn btn-link text-secondary" data-bs-dismiss="modal">Cancelar</button>
                    <button type="button" class="btn-confirmar-sm" id="saveClaseBtn">Guardar</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal: Confirmar eliminar clase -->
    <div class="modal fade" id="deleteClaseModal" tabindex="-1">
        <div class="modal-dialog modal-dialog-centered modal-sm">
            <div class="modal-content modal-kikibrows">
                <div class="modal-body text-center py-4">
                    <i class="fas fa-exclamation-triangle text-warning fa-3x mb-3"></i>
                    <h5>¿Eliminar esta clase?</h5>
                    <p class="text-muted small mb-0">Esta acción no se puede deshacer.</p>
                </div>
                <div class="modal-footer border-0 justify-content-center pt-0">
                    <button type="button" class="btn btn-link text-secondary" data-bs-dismiss="modal">Cancelar</button>
                    <button type="button" class="btn btn-danger" id="confirmDeleteClase">Eliminar</button>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
    <script src="js/componenteAdmin.js"></script>
    <script src="js/gestorModulos.js"></script>
</body>
</html>