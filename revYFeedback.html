<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>KIKIBROWS - Revisiones</title>

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css">

    <link rel="stylesheet" href="css/fonts.css">
    <link rel="stylesheet" href="css/layoutAdmin.css">
    <link rel="stylesheet" href="css/account.css">
    <link rel="stylesheet" href="css/dashboardAdmin.css">
    <link rel="stylesheet" href="css/revisionesAdmin.css">
</head>
<body>

    <header id="navbar-global"></header>

    <div id="main-container" class="d-flex">
        <aside id="sidebar"></aside>

        <main class="p-4 w-100" id="dashboard-content">
            <div class="account-card p-4 h-100">

                <div class="d-flex align-items-center mb-4 gap-3">
                    <div class="d-flex align-items-center justify-content-center rounded p-2" style="background-color: #D4E1C5; width: 50px; height: 50px;">
                        <i class="fas fa-clipboard-check fs-2" style="color: #8A835A;"></i>
                    </div>
                    <h1 class="m-0 fs-3">Revisiones</h1>
                </div>

                <div class="mb-4 border-bottom pb-2">
                    <button id="tab-pendientes" class="btn fw-bold me-3" style="border-bottom: 3px solid #8A835A; color: #333; border-radius: 0;">Pendientes</button>
                    <button id="tab-finalizadas" class="btn fw-bold text-muted" style="border-radius: 0;">Finalizadas</button>
                </div>

                <div class="revision-table-container">
                    <!-- Header de la tabla -->
                    <div class="row g-0 mb-3 fw-bold p-2 rounded" style="background-color: #D4E1C5;">
                        <div class="col-1 text-center">#</div>
                        <div class="col-3">Curso</div>
                        <div class="col-3">Clase</div>
                        <div class="col-2">Fecha</div>
                        <div class="col-2">Usuario</div>
                        <div class="col-1 text-center">Estado</div>
                    </div>

                    <!-- Loading indicator -->
                    <div id="loading-indicator" class="text-center py-4">
                        <div class="spinner-border text-warning" role="status">
                            <span class="visually-hidden">Cargando...</span>
                        </div>
                        <p class="text-muted mt-2">Cargando entregas...</p>
                    </div>

                    <!-- Empty state -->
                    <div id="empty-state-revisiones" class="d-none text-center py-4">
                        <i class="fas fa-inbox fa-3x text-muted mb-3"></i>
                        <p class="text-muted fst-italic">No hay entregas pendientes de revisión.</p>
                    </div>

                    <!-- Rows dinámicas -->
                    <div id="entregas-table-body"></div>

                    <!-- Paginación dinámica -->
                    <div id="pagination-container" class="d-flex justify-content-center mt-4"></div>

                </div>
            </div>
        </main>
    </div>

    <!-- Modal de Revisión -->
    <div class="modal fade" id="revisionModal" tabindex="-1" aria-hidden="true">
      <div class="modal-dialog modal-xl modal-dialog-centered">
        <div class="modal-content account-card border-0 p-3">
          <div class="modal-header border-0 pb-0">
            <h5 class="modal-title fw-bold">Revisión de Entrega</h5>
            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Cerrar"></button>
          </div>
          <div class="modal-body pt-4">

            <p><strong>Entrega:</strong> <span id="modal-curso-modulo"></span></p>
            <p><strong>Enviado por:</strong> <span id="modal-usuario"></span> el <span id="modal-fecha"></span></p>

            <div class="row mt-4">
                <div class="col-lg-7">
                    <div id="visualizador-container" style="width: 100%; min-height: 300px; background: #000; border-radius: 8px; overflow: hidden; display: flex; align-items: center; justify-content: center;">
                        <p class="text-muted">Selecciona una entrega para ver el archivo.</p>
                    </div>
                </div>

                <div class="col-lg-5">
                    <form id="revision-form">
                        <div class="mb-3">
                            <label for="feedbackArea" class="form-label text-muted">Feedback</label>
                            <textarea class="form-control" id="feedbackArea" rows="5" placeholder="Escribe aquí tu corrección..." style="background-color: rgba(255,255,255,0.5);"></textarea>
                        </div>
                        <div class="mb-3">
                            <label for="calificacionDropdown" class="form-label text-muted">Calificación</label>
                            <select class="form-select" id="calificacionDropdown" style="background-color: rgba(255,255,255,0.5);">
                                <option value="" disabled selected>Selecciona...</option>
                                <option value="aprobada">Aprobada</option>
                                <option value="rechazada">Rechazada</option>
                            </select>
                        </div>
                        <div class="d-grid gap-2 mt-4">
                            <button type="submit" id="submit-calificacion-btn" class="btn text-white fw-bold" style="background-color: #8A835A;">
                                <i class="fas fa-check-circle me-2"></i> Calificar
                            </button>
                        </div>
                    </form>
                </div>
            </div>

          </div>
        </div>
      </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
    <script type="module" src="js/authGuardAdmin.js"></script>
    <script type="module" src="js/componenteAdmin.js"></script>
    <script src="js/dashboardAdmin.js"></script>
    <script type="module" src="js/revisionesAdmin.js"></script>

</body>
</html>
